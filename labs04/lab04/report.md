# Отчет по лабораторной работе 4
# Композиция, Агрегация и Работа со сложными структурами

**Дата:** 05-12-2025
**Семестр:** 2 курс, 1 семестр
**Группа:** ПИН-Б-О-24-2
**Дисциплина:** Технологии программирования
**Студент:** Осипов Александр Сергеевич

## Цель работы

Освоить принципы композиции и агрегации для построения сложных объектных структур. Реализовать механизмы управления связями между объектами, валидации данных и комплексной сериализации/десериализации системы.

## Теоретическая часть

**Композиция** - это отношение "часть-целое", где часть не может существовать без целого. При удалении целого удаляются и все его части. В нашем случае проект содержит команду сотрудников (композиция).

**Агрегация** - это отношение "часть-целое", где часть может существовать независимо от целого. При удалении целого части остаются. В нашем случае компания содержит отделы и проекты (агрегация).

**Валидация данных** - процесс проверки корректности данных перед их использованием. Реализуется через кастомные исключения и проверки в методах.

## Практическая часть

### Выполненные задачи

- Задача 1: Создан класс `Project` с композицией команды сотрудников
- Задача 2: Создан класс `Company` с агрегацией отделов и проектов
- Задача 3: Созданы кастомные исключения для обработки ошибок
- Задача 4: Реализована валидация данных и проверки перед удалением
- Задача 5: Реализована полная сериализация/десериализация компании
- Задача 6: Реализованы методы экспорта в CSV (`export_employees_csv`, `export_projects_csv`)
- Задача 7: Реализованы методы анализа данных (`get_department_stats`, `get_project_budget_analysis`, `find_overloaded_employees`)
- Задача 8: Реализованы методы планирования (`assign_employee_to_project`, `check_employee_availability`)
- Задача 9: Реализован перенос сотрудников между отделами
- Задача 10: Реализована проверка уникальности ID сотрудников и проектов
- Задача 11: Реализован генератор финансового отчета

### Ключевые фрагменты кода

#### Класс Project с композицией

```python
class Project:
    def __init__(self, project_id: int, name: str, description: str, 
                 deadline: str, status: str = "planning"):
        self.__project_id = project_id
        self.__name = name
        self.__team: list[AbstractEmployee] = []  # Композиция
```

#### Класс Company с агрегацией и методами анализа

```python
class Company:
    def __init__(self, name: str):
        self.__name = name
        self.__departments: list[Department] = []  # Агрегация
        self.__projects: list[Project] = []       # Агрегация
        self.__employee_ids: set[int] = set()      # Проверка уникальности
    
    def export_employees_csv(self, filename: str) -> None:
        """Экспортирует отчет по сотрудникам в CSV."""
        # Реализация экспорта
    
    def get_department_stats(self) -> dict:
        """Возвращает статистику по отделам."""
        # Реализация анализа
```

#### Методы планирования

```python
def assign_employee_to_project(self, employee_id: int, project_id: int) -> bool:
    """Назначает сотрудника на проект."""
    employee = self.find_employee_by_id(employee_id)
    project = self.find_project(project_id)
    if employee and project:
        project.add_team_member(employee)
        return True
    return False

def check_employee_availability(self, employee_id: int) -> bool:
    """Проверяет доступность сотрудника."""
    project_count = sum(1 for proj in self.__projects 
                       if employee in proj.get_team())
    return project_count < 3
```

## Результаты выполнения

### Структура проекта

Проект организован согласно шаблону:
```
employee_management_system/
├── src/
│   ├── core/          # AbstractEmployee, Employee, Department, Company, Project
│   ├── employees/     # Manager, Developer, Salesperson
│   ├── factories/     # EmployeeFactory
│   └── utils/          # exceptions
├── examples/          # demo_part4.py
├── data/
│   ├── json/          # JSON файлы
│   └── csv/           # CSV отчеты
└── docs/              # Документация
```

### Пример работы программы

```bash
================================================================================
Демонстрация работы системы учета сотрудников
Часть 4: Композиция, Агрегация и Работа со сложными структурами
================================================================================

1. Создание комплексной структуры:
--------------------------------------------------------------------------------
Создана компания: TechInnovations
Созданы отделы: ['Development', 'Sales']
Добавлены сотрудники в отделы
Созданы проекты: ['AI Platform', 'Web Portal']
Сформированы команды проектов

4. Сериализация и экспорт:
--------------------------------------------------------------------------------
Компания сохранена в JSON: data/json/company_data.json
Компания загружена из JSON: TechInnovations
Экспортированы отчеты в CSV

5. Анализ данных:
--------------------------------------------------------------------------------
Статистика по отделам:
  Development: 2 сотрудников, зарплата: 17200.00
  Sales: 1 сотрудников, зарплата: 11500.00

Анализ проектов:
  Всего проектов: 2
  Общий бюджет: 17200.00
```

### Тестирование

- Модульные тесты пройдены - все классы работают корректно
- Интеграционные тесты пройдены - композиция и агрегация работают
- Валидация данных работает - все исключения обрабатываются корректно
- Экспорт в CSV работает - отчеты генерируются успешно
- Методы анализа работают - статистика рассчитывается корректно

## Выводы

1. **Композиция и агрегация реализованы корректно** - проект содержит команду (композиция), компания содержит отделы и проекты (агрегация).

2. **Валидация данных работает** - кастомные исключения позволяют обрабатывать ошибки на разных уровнях системы, проверка уникальности ID предотвращает дублирование.

3. **Сериализация обеспечивает персистентность** - возможность сохранять и загружать всю структуру компании из JSON файла, экспорт в CSV для отчетности.

4. **Методы анализа и планирования реализованы** - система предоставляет инструменты для анализа данных компании, планирования проектов и управления ресурсами.

5. **Система готова к расширению** - архитектура позволяет легко добавлять новые функции и классы.

## Ответы на контрольные вопросы

1. **В чем разница между композицией и агрегацией?** - Композиция - это сильная связь, где часть не может существовать без целого. Агрегация - это слабая связь, где часть может существовать независимо.

2. **Когда использовать композицию, а когда агрегацию?** - Композиция используется, когда объект является неотъемлемой частью другого (например, команда проекта). Агрегация - когда объект может существовать независимо (например, отдел в компании).

3. **Зачем нужны кастомные исключения?** - Кастомные исключения позволяют более точно описывать ошибки и упрощают их обработку в коде.

4. **Как работает сериализация сложных структур?** - Сериализация рекурсивно преобразует все объекты в словари, которые затем сохраняются в JSON. При десериализации объекты восстанавливаются в обратном порядке.

5. **Как обеспечить целостность данных при сериализации?** - Необходимо сохранять связи между объектами (например, ID сотрудников в проектах) и восстанавливать их при загрузке.

## Приложения

- [Исходный код: `employee_management_system/src/`](employee_management_system/src/)
- [Демонстрация: `employee_management_system/examples/demo_part4.py`](employee_management_system/examples/demo_part4.py)
- [Задание: `task.md`](task.md)
- [Структура проекта: соответствует шаблону из `lab0404_py_ОТЧЕТ4+5+8+9_Структура_проекта.md`]()
